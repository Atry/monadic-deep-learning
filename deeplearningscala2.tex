%%%% Small single column format, used for CIE, CSUR, JACM, JDIQ, JEA, JERIC, JETC, TAAS, TACCESS, TACO, TALG, TALLIP (formerly TALIP), TCPS, TEAC, TECS, THRI, TIIS, TISSEC, TIST, TKDD, TMIS, TOCE, TOCHI, TOCL, TOCS, TOCT, TODAES, TODS, TOIS, TOIT, TOMACS, TOMM (formerly TOMCCAP), TOMPECS, TOMS, TOPC, TOPLAS, TOPS, TOS, TOSEM, TOSN, TRETS, TSAS, TSC, TSLP, TWEB.
% \documentclass[format=acmsmall, review=false, screen=true]{acmart}

%%%% Large single column format, used for IMWUT, JOCCH, PACMPL, POMACS, TAP, PACMHCI
% \documentclass[acmlarge]{acmart}

%%%% Large double column format, used for TOG
% \documentclass[acmtog, authorversion]{acmart}

%%%% Generic manuscript mode
% \documentclass[manuscript,review,screen]{acmart}

%% For double-blind review submission, w/o CCS and ACM Reference (max submission space)
\documentclass[acmsmall,10pt,review,screen,anonymous]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For double-blind review submission, w/ CCS and ACM Reference
%\documentclass[sigplan,10pt,review,anonymous]{acmart}\settopmatter{printfolios=true}
%% For single-blind review submission, w/o CCS and ACM Reference (max submission space)
%\documentclass[sigplan,10pt,review]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For single-blind review submission, w/ CCS and ACM Reference
%\documentclass[sigplan,10pt,review]{acmart}\settopmatter{printfolios=true}
%% For final camera-ready submission, w/ required CCS and ACM Reference
%\documentclass[sigplan,10pt]{acmart}\settopmatter{}

%\setcitestyle{super,sort&compress}
\bibliographystyle{ACM-Reference-Format}
\citestyle{acmauthoryear}

\usepackage{booktabs} % For formal tables

\usepackage[ruled]{algorithm2e} % For algorithms

% Workaround for https://tex.stackexchange.com/questions/341969/non-discriptive-error-when-combining-minted-and-libertine
% \makeatletter
% \def\mdseries@tt{m}
% \makeatother
% \usepackage{minted}
% \usepackage{fancyvrb}
\usepackage{listings}
\lstset{
  language=Scala,
  basicstyle=\ttfamily,
  breaklines=true,
  captionpos=b,
  tabsize=2,
  frame=top,frame=bottom,
%   frame=single,
%   frame=leftline,
%   fancyvrb=true,
%   frame=shadowbox,
%   frame=leftline,
}

% \usepackage{titlesec}
% \titleformat{\subsubsection}
%   {\normalfont\normalsize\itshape}{\thesubsubsection}{1em}{}
% \titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{0ex plus .2ex}

\usepackage{markdown}

\usepackage{color}
\usepackage{graphviz}
\usepackage[inline]{enumitem}

\usepackage{glossaries}

\makeglossaries

\newglossaryentry{plug-in}{
  name={plug-in},
  description={is a Scala \lstinline{trait} designed to be instantiated by \href{https://javadoc.io/page/com.thoughtworks.feature/factory_2.11/latest/com/thoughtworks/feature/Factory.html}{\lstinline{Factory}}, along with other plug-ins}
}

\newglossaryentry{differentiable function}{
  name={differentiable function},
  description={is a Scala function that returns a \gls{differentiable expression}. It may represent a loss functions, a neural network or a subset of a neural network (e.g. a dense block in DenseNet\cite{iandola2014densenet})}
}

\newglossaryentry{differentiable expression}{
  name={differentiable expression},
  description={is a differentiable computational graph whose type is \lstinline{DoubleLayer}, \lstinline{FloatLayer}, \lstinline{INDArrayLayer}, or other subtypes of \href{https://javadoc.io/page/com.thoughtworks.deeplearning/plugins-layers_2.11/latest/com/thoughtworks/deeplearning/plugins/Layers$Layer.html}{\lstinline{Layer}}}
}

\newglossaryentry{trainable variable}{
  name={trainable variable},
  description={is a scalar or vector weight in a mode, whose type is \lstinline{DoubleWeight}, \lstinline{FloatWeight}, \lstinline{INDArrayWeight}, or other subtypes of \href{https://javadoc.io/page/com.thoughtworks.deeplearning/plugins-weights_2.11/latest/com/thoughtworks/deeplearning/plugins/Weights$Weight.html}{\lstinline{Weight}}}  
}

% Metadata Information
\acmJournal{PACMPL}
% \acmVolume{9}
% \acmNumber{4}
% \acmArticle{39}
% \acmYear{2010}
% \acmMonth{3}

%\acmBadgeL[http://ctuning.org/ae/ppopp2016.html]{ae-logo}
%\acmBadgeR[http://ctuning.org/ae/ppopp2016.html]{ae-logo}

% Copyright
% \setcopyright{acmcopyright}
\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\setcopyright{usgov}
%\setcopyright{usgovmixed}
%\setcopyright{cagov}
%\setcopyright{cagovmixed}

% DOI
\acmDOI{0000001.0000001}


% Document starts
\begin{document}
% Title portion
\title{DeepLearning.scala 2.0: Statically Typed Neural Networks}
%  \titlenote{This is a titlenote}
\subtitle{Solving the harder version of expression problem and performing monadic automatic differentiation in parallel}
%  \subtitlenote{Subtitle note}

\author{Yang Bo}
% \orcid{1234-5678-9012-3456}
\affiliation{%
  \institution{ThoughtWorks, Inc}
%   \streetaddress{104 Jamestown Rd}
%   \city{Williamsburg}
%   \state{VA}
%   \postcode{23185}
%   \country{USA}
}
\email{atryyang@thoughtworks.com}
\author{Zhang Zhihao}
\affiliation{%
  \institution{ThoughtWorks, Inc}
%   \streetaddress{104 Jamestown Rd}
%   \city{Williamsburg}
%   \state{VA}
%   \postcode{23185}
%   \country{USA}
}
\email{zhazhang@thoughtworks.com}
\author{Marisa Kirisame} 
\affiliation{%
 \institution{University of Washington}
%  \streetaddress{Rono-Hills}
 \city{Seattle} 
 \state{Washington}
 \country{USA}}
\email{lolisa@marisa.moe}

% \renewcommand\shortauthors{Zhou, G. et al}

\begin{abstract}
The Java and Scala community built a very successful big data ecosystem, however, most of neural networks running on it are modeled in dynamically typed programming languages. Dynamically typed deep learning frameworks treat neural networks as differentiable expressions that contain many trainable variables, and perform automatic differentiation on those expressions when training them.

Until 2017, all deep learning frameworks in statically typed language do not support the same features. Their users are not able to custom algorithms unless creating plenty of boilerplate code for hard-coded back-propagation.

We solved this problem in DeepLearning.scala 2.0. Our contributions are:

\begin{itemize}
  \item We discovered a novel approach to perform automatic differentiation in reverse mode for statically typed functions that contain multiple \glspl{trainable variable}.
  \item We designed a set of monads and monad transformers, which allow users to create monadic expressions that represent dynamic neural networks.
  \item Along with these monads, we provide some applicative functors, to perform multiple calculations in parallel.
  \item We solved the harder version of Expression Problem, which allows users to create \glspl{plug-in} that not only add new types and operations, but also modify existing types and operations.
\end{itemize}

Together of these features, users of DeepLearning.scala are able to create complex neural networks in an intuitive and concise way, and still keep type safe.
\end{abstract}


%
% The code below should be generated by the tool at
% http://dl.acm.org/ccs.cfm
% Please copy and paste the code instead of the example below. 
%
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10002950.10003714.10003715.10003748</concept_id>
<concept_desc>Mathematics of computing~Automatic differentiation</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10010520.10010521.10010542.10010294</concept_id>
<concept_desc>Computer systems organization~Neural networks</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10011012</concept_id>
<concept_desc>Software and its engineering~Functional languages</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10011021</concept_id>
<concept_desc>Software and its engineering~Multiparadigm languages</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10011011</concept_id>
<concept_desc>Software and its engineering~Object oriented languages</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10011019</concept_id>
<concept_desc>Software and its engineering~Extensible languages</concept_desc>
<concept_significance>100</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011050.10011017</concept_id>
<concept_desc>Software and its engineering~Domain specific languages</concept_desc>
<concept_significance>300</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011066.10011067</concept_id>
<concept_desc>Software and its engineering~Object oriented frameworks</concept_desc>
<concept_significance>100</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011074.10011092.10011093</concept_id>
<concept_desc>Software and its engineering~Object oriented development</concept_desc>
<concept_significance>100</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10010175</concept_id>
<concept_desc>Software and its engineering~Parallel programming languages</concept_desc>
<concept_significance>100</concept_significance>
</concept>
<concept>
<concept_id>10011007.10011006.10011008.10011009.10011016</concept_id>
<concept_desc>Software and its engineering~Data flow languages</concept_desc>
<concept_significance>100</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Computer systems organization~Neural networks}
\ccsdesc[500]{Software and its engineering~Multiparadigm languages}
\ccsdesc[300]{Mathematics of computing~Automatic differentiation}
\ccsdesc[300]{Software and its engineering~Functional languages}
\ccsdesc[300]{Software and its engineering~Object oriented languages}
\ccsdesc[300]{Software and its engineering~Domain specific languages}
\ccsdesc[100]{Software and its engineering~Extensible languages}
\ccsdesc[100]{Software and its engineering~Object oriented frameworks}
\ccsdesc[100]{Software and its engineering~Object oriented development}
\ccsdesc[100]{Software and its engineering~Parallel programming languages}
\ccsdesc[100]{Software and its engineering~Data flow languages}

%
% End generated code
%


\keywords{neural networks, type class, path-dependent type, monad, expression problem, scala}




\maketitle

% % The default list of authors is too long for headers.
% \renewcommand{\shortauthors}{G. Zhou et al.}

\input{deeplearningscala2-body}


\end{document}
